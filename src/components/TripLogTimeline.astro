---
import travel from '../data/travel.json';

const trips = (travel.tripLog ?? []).sort(
  (a, b) => new Date(b.startDate).getTime() - new Date(a.startDate).getTime()
);

const formatDate = (dateStr: string) => {
  const d = new Date(dateStr + 'T00:00:00');
  return d.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });
};
---

<section class="card">
  <h2 class="text-2xl font-heading font-bold mb-6">Trip log</h2>
  {trips.length === 0 ? (
    <p class="text-sm text-text-muted">No trips logged yet. Check back soon.</p>
  ) : (
    <div class="space-y-4">
      {trips.map((trip) => (
        <div class="flex flex-col md:flex-row md:items-baseline md:justify-between border-b border-border/60 pb-4 last:border-b-0 last:pb-0">
          <div>
            <h3 class="text-lg font-heading font-bold text-text">
              {trip.destination}{trip.stateOrRegion ? `, ${trip.stateOrRegion}` : ''}, {trip.country}
            </h3>
            {trip.highlights && <p class="text-sm text-text-muted">{trip.highlights}</p>}
            {trip.notes && <p class="text-sm text-text-muted mt-1">{trip.notes}</p>}
          </div>
          <div class="text-sm text-text-muted mt-2 md:mt-0 whitespace-nowrap">
            {formatDate(trip.startDate)}
            {trip.endDate && trip.endDate !== trip.startDate
              ? ` â€“ ${formatDate(trip.endDate)}`
              : ''}
          </div>
        </div>
      ))}
    </div>
  )}
</section>
